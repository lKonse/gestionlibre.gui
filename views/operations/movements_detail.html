{{extend 'layout.html'}}
<h1>Movements (Operations)</h1>

{{try:}}
  <h3>{{=operation.document_id.description}} {{=operation.operation_id}}</h3>
{{ except AttributeError: }}
  <h3>{{=T("Document")}} {{=operation.operation_id}}</h3>
  <h3>{{=T("No document type specified")}}</h3>
{{ pass }}

{{=HR()}}
{{try:}}
Supplier: {{=supplier.legal_name}}. TAX ID: {{=supplier.tax_identification}} | Customer: {{=customer.legal_name}}. TAX ID: {{=customer.tax_identification}} | {{ =A("Customer current account", _href=URL(a=config.APP_NAME, c="crm", f="customer_current_account_status", args=["customer", operation.customer_id])) }} | {{ =A("Subcustomer current account", _href=URL(a=config.APP_NAME, c="crm", f="customer_current_account_status", args=["subcustomer", operation.subcustomer_id])) }}
{{=HR()}}
{{except (ValueError, KeyError, TypeError, AttributeError):}}
Error trying to get the operation customer/supplier data from database
{{pass}}
<h3>Price list:
{{if price_list is not None:}}
{{=price_list.description}}
{{else:}}
None selected
{{pass}}
</h3>

{{=A(T("Modify header"), _href=URL(a=config.APP_NAME, c="operations", f="movements_modify_header"))}} | {{=A("Add item", _href=URL(a=config.APP_NAME, c="operations", f="movements_add_item"))}} | {{=A("Add payment method", _href=URL(a=config.APP_NAME, c="operations", f="movements_add_payment_method"))}} | {{=A("Add article", _href=URL(a=config.APP_NAME, c="operations", f="movements_articles"))}} | {{=A("Add check", _href=URL(a=config.APP_NAME, c="operations", f="movements_add_check"))}} | {{=A("Add tax", _href=URL(a=config.APP_NAME, c="operations", f="movements_add_tax"))}} | {{=A("Current account", _href=URL(a=config.APP_NAME, c="operations", f="movements_current_account_concept"))}} | {{=A("Discount/Surcharges", _href=URL(a=config.APP_NAME, c="operations", f="movements_add_discount_surcharge"))}} | {{=A("Process operation", _href=URL(a=config.APP_NAME, c="operations", f="movements_process"))}} | {{=A("Select price list", _href=URL(a=config.APP_NAME, c="operations", f="movements_price_list"))}}

{{=HR()}}
<h3>Options</h3>
<ul>
<li>
Operation
{{if update_stock == True:}}
 updates stock
{{elif update_stock == False:}}
 does not update stock
{{pass}} ({{=A("Change", _href=URL(a=config.APP_NAME, c="operations", f="movements_option_update_stock"))}})
</li>
<li>
Warehouse: {{=warehouse}} ({{=A("Change", _href=URL(a=config.APP_NAME, c="operations", f="movements_select_warehouse"))}})
</li>
<li>
Taxes are
{{if update_taxes == True:}}
 updated
{{elif update_taxes == False:}}
 not updated
{{pass}} ({{=A("Change", _href=URL(a=config.APP_NAME, c="operations", f="movements_option_update_taxes"))}})
</li>
{{=LI(A("Print this document", _href=URL(a=config.APP_NAME, c="output", f="operation", args=["operation", operation.operation_id])))}}
</ul>

{{=BEAUTIFY(movements)}}

{{=HR()}}
Total amount: {{=operation.amount}}
